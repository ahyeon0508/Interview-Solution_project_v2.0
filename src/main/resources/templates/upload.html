<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title></title>
    <link href="../static/css/upload.css" rel="stylesheet" />
    <!--<script th:src="@{/js/.js}"></script>-->

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous">

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js" integrity="sha384-ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW" crossorigin="anonymous"></script>

    <script src="https://code.jquery.com/jquery-3.5.1.js" integrity="sha256-QWo7LDvxbWT2tbbQ97B53yJnYU3WhH/C8ycbRAkjPDc=" crossorigin="anonymous"></script>

    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.4/jquery.min.js" type="text/javascript"></script>

    <script type="text/javascript">
        $(document).ready(function() {
            // 옵션추가 버튼 클릭시
            $("#addItemBtn").click(function() {
                // item 의 최대번호 구하기
                var lastItemNo = $("#example tr:last").attr("class").replace("item", "");

                var newitem = $("#example tr:eq(1)").clone();
                fncRowReset(newitem);
                newitem.removeClass();
                newitem.find("td:eq(0)").attr("rowspan", "1");
                newitem.addClass("item" + (parseInt(lastItemNo) + 1));

                $("#example").append(newitem);
            });


            // 삭제버튼 클릭시
            $("#delBtn").live("click", function() {
                var clickedRow = $(this).parent().parent();
                var cls = clickedRow.attr("class");

                // 각 항목의 첫번째 row를 삭제한 경우 다음 row에 td 하나를 추가해 준다.
                if (clickedRow.find("td:eq(0)").attr("rowspan")) {
                    if (clickedRow.next().hasClass(cls)) {
                        clickedRow.next().prepend(clickedRow.find("td:eq(0)"));
                    }
                }

                if ($("#example tr").length <= 2) {
                    fncRowReset(clickedRow);
                } else {
                    clickedRow.remove();
                }
            });

            //행 초기화
            fncRowReset = function(obj) {

                $(obj).find(':input').each(function() {

                    this.value = '';

                    this.checked = '';

                });

            };
        });
    </script>

    <script>
        $(function() {
            $("#InputInfo").click(function() {
                while ($("#example tr").length > 2) {
                    $("#example tr:eq(1)").remove();
                }
                fncRowReset("#example tr");
            });

            fncRowReset = function(obj) {

                $(obj).find(':input').each(function() {

                    this.value = '';

                    this.checked = '';

                });

            };
        });
    </script>


</head>

<body>
    <p class="header1">내 서류 정보 추가</p>
    <div class="container1">
        <p class="header2">내신 성적</p>
        <div class="textbox">
            <div class="input-group">
                <select class="form-select" id="grade" aria-label="Example select with button addon">
              <option selected>학년</option>
              <option value="1">1학년</option>
              <option value="2">2학년</option>
              <option value="3">3학년</option>
            </select>
                <select class="form-select" id="semester" aria-label="Example select with button addon">
                <option selected>학기</option>
                <option value="1">1학기</option>
                <option value="2">2학기</option>
              </select>
                <button id="InputInfo" class="btn btn-outline-secondary" type="button" onclick="InputInfo()">입력</button>
            </div>
        </div>
        <span class="header2"><span id="input-grade" class="header3"></span><span class="header3">학년&nbsp;</span><span id="input-semester" class="header3"></span><span class="header3">학기</span></span>
        <div class="textbox">
            <table id="example" border="1px">
                <tr>
                    <th>교과</th>
                    <th>과목</th>
                    <th>단위수</th>
                    <th>석차등급</th>
                    <th>원점수</th>
                    <th>과목평균</th>
                    <th>표준편차</th>
                    <th>성취도</th>
                    <th>수강자수</th>
                    <th>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</th>
                </tr>
                <tr class="item1">
                    <td><input type="text" /></td>
                    <td><input type="text" /></td>
                    <td><input type="number" min="1" max="9"></td>
                    <td><input type="number" min="1" max="9"></td>
                    <td><input type="number" min="0" max="100"></td>
                    <td><input type="number" step="0.1" min="0" max="100"></td>
                    <td><input type="number" step="0.1" min="0" max="100"></td>
                    <td><select id="Achievement" aria-label="Example select with button addon">
                        <option selected></option>
                        <option value="A">A</option>
                        <option value="B">B</option>
                        <option value="C">C</option>
                        <option value="D">D</option>
                        <option value="E">E</option>
                        <option value="P">P</option>
                      </select></td>
                    <td><input type="number" min="1" max="1000"></td>
                    <td><button type="button" class="btn btn-outline-secondary" id="delBtn">삭제</button></td>
                </tr>
            </table>
            <button type="button" class="btn btn-outline-secondary" id="addItemBtn">추가</button>
        </div>
        <button type="submit" value="Submit1" type="button" class="btn btn-outline-secondary" id="save1" onclick="showalert()">등록</button>
    </div>
    <div class="container1">
        <p class="header2">학교 생활 기록부</p>
        <div class="upload">
            <div class="input-group">
                <div class="form-control" aria-label="Recipient's username with two button addons">
                    <span>파일이 없습니다.</span>
                </div>
                <label class="btn btn-outline-secondary" for="image_uploads">찾기</label>
                <button type="submit" value="Submit2" class="btn btn-outline-secondary" id="save2">등록</button>
            </div>
            <input type="file" id="image_uploads" name="image_uploads" accept=".jpg, .jpeg, .png" multiple>
        </div>
    </div>
    <div class="container1">
        <p class="header2">자기소개서</p>
        <div class="textbox">
            <table>
                <th>1. 고등학교 재학 기간* 중 자신의 진로와 관련해 어떤 노력을 해왔는지 본인에게 의미 있는 학습 경험과 교내 활동을 중심으로 기술해 주시기 바랍니다.<br><small>* 검정고시 출신자는 중학교 졸업 후 고등학교 재학 기간에 준하는 기간의 경험 기술</small></th>
                <tr>
                    <td><textarea class="form-control" id="content1" rows="8" style="width:100%; border: 0; resize: none;" maxlength="1500"></textarea><span id="counter1">###</span></td>
                </tr>
            </table>
        </div>
        <div class="textbox">
            <table>
                <th>2. 고등학교 재학 기간* 중 타인과 공동체를 위해 노력한 경험과 이를 통해 배운 점을 기술해 주시기 바랍니다.<br><small>* 검정고시 출신자는 중학교 졸업 후 고등학교 재학 기간에 준하는 기간의 경험 기술</small></th>
                <tr>
                    <td><textarea class="form-control" id="content2" rows="8" style="width:100%; border: 0; resize: none;" maxlength="800"></textarea><span id="counter2">###</span></td>
                </tr>
            </table>
        </div>
        <div class="textbox">
            <table>
                <th>3. <input type="text" id="free" placeholder="대학별 자율 문항을 입력해 주시기 바랍니다."></th>
                <tr>
                    <td><textarea class="form-control" id="content3" rows="8" style="width:100%; border: 0; resize: none;" maxlength="800"></textarea><span id="counter3">###</span></td>
                </tr>
            </table>
        </div>
        <button type="submit" value="Submit3" class="btn btn-outline-secondary" id="save3">등록</button>
    </div>

    <script>
        function InputInfo() {
            var grade = document.getElementById("input-grade");
            if (document.getElementById("grade").value != '학년') {
                grade.innerText = document.getElementById("grade").value;
            }

            var semester = document.getElementById("input-semester");
            if (document.getElementById("semester").value != '학기') {
                semester.innerText = document.getElementById("semester").value;
            }

        }
    </script>
    <script>
        function showalert() {
            if (document.getElementById("grade").value == '학년' || document.getElementById("semester").value == '학기') {
                window.alert("학년과 학기를 입력해주시기 바랍니다.")
            }
        }
    </script>
    <script>
        const input = document.querySelector('input[type="file"]');
        const preview = document.querySelector('.form-control');

        input.addEventListener('change', updateImageDisplay);

        function updateImageDisplay() {
            while (preview.firstChild) {
                preview.removeChild(preview.firstChild);
            }

            const curFiles = input.files;
            if (curFiles.length === 0) {
                const para = document.createElement('span');
                para.textContent = '파일이 없습니다.';
                preview.appendChild(para);
            } else {
                const list = document.createElement('span');
                preview.appendChild(list);

                for (const file of curFiles) {
                    const listItem = document.createElement('span');
                    const para = document.createElement('span');

                    if (validFileType(file)) {
                        para.textContent = `${file.name}`;

                        listItem.appendChild(para);
                    } else {
                        para.textContent = `${file.name}는 이미지 파일이 아닙니다.`;
                        listItem.appendChild(para);
                    }

                    list.appendChild(listItem);
                }
            }
        }

        // https://developer.mozilla.org/en-US/docs/Web/Media/Formats/Image_types
        const fileTypes = [
            'image/apng',
            'image/bmp',
            'image/gif',
            'image/jpeg',
            'image/pjpeg',
            'image/png',
            'image/svg+xml',
            'image/tiff',
            'image/webp',
            `image/x-icon`
        ];

        function validFileType(file) {
            return fileTypes.includes(file.type);
        }
    </script>

    <script>
        $(function() {
            $('#content1').keyup(function(e) {
                var content = $(this).val();
                $('#counter1').html(content.length + '/1500');
            });
            $('#content1').keyup();
        });
    </script>
    <script>
        $(function() {
            $('#content2').keyup(function(e) {
                var content = $(this).val();
                $('#counter2').html(content.length + '/800');
            });
            $('#content2').keyup();
        });
    </script>
    <script>
        $(function() {
            $('#content3').keyup(function(e) {
                var content = $(this).val();
                $('#counter3').html(content.length + '/800');
            });
            $('#content3').keyup();
        });
    </script>
</body>

</html>